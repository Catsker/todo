{"ast":null,"code":"import { createStore } from 'vuex';\nconst StorageKey = 'vue-todo-app';\nconst saveState = state => {\n  localStorage.setItem(StorageKey, JSON.stringify(state));\n};\nconst loadState = () => {\n  const json = localStorage.getItem(StorageKey);\n  return json ? JSON.parse(json) : null;\n};\nconst localStoragePlugin = store => {\n  store.subscribe((mutation, state) => {\n    saveState(state);\n  });\n};\nexport default createStore({\n  plugins: [localStoragePlugin],\n  state() {\n    const savedState = loadState();\n    return savedState || {\n      tasks: [],\n      add_task: '',\n      filter: 'all'\n    };\n  },\n  getters: {\n    showTasks: state => state.tasks,\n    showDoneTasks: state => {\n      const completedCount = state.tasks.reduce((count, task) => task.completed ? count + 1 : count, 0);\n      return `${completedCount}/${state.tasks.length}`;\n    }\n  },\n  mutations: {\n    ADD_TASK(state, taskText) {\n      const newTask = {\n        id: Date.now(),\n        text: taskText.trim(),\n        completed: false,\n        subtasks: []\n      };\n      if (newTask.text) state.tasks.push(newTask);\n    },\n    ADD_SUBTASK(state, {\n      taskId,\n      subtaskText\n    }) {\n      const newSubtask = {\n        id: Date.now(),\n        text: subtaskText.trim(),\n        completed: false\n      };\n      const currentTask = state.tasks.find(task => task.id === taskId);\n      if (newSubtask.text && currentTask) {\n        currentTask.subtasks.push(newSubtask);\n      }\n      update_tasks_checked_state(state, currentTask);\n    },\n    DELETE_TASK(state, taskId) {\n      state.tasks = state.tasks.filter(task => task.id !== taskId);\n    },\n    DELETE_SUBTASK(state, {\n      taskId,\n      subtaskId\n    }) {\n      const task = state.tasks.find(task => task.id === taskId);\n      if (!task?.subtasks) return;\n      const index = task.subtasks.findIndex(s => s.id === subtaskId);\n      if (index !== -1) {\n        task.subtasks.splice(index, 1);\n        task.completed = task.subtasks.length === 0 ? false : task.subtasks.every(s => s.completed);\n      }\n    },\n    UPDATE_TASK_CHECKED(state, taskId) {\n      const task = state.tasks.find(t => t.id === taskId);\n      if (task) {\n        task.completed = !task.completed;\n        update_subtasks_checked_state(state, task);\n      }\n    },\n    UPDATE_SUBTASK_CHECKED(state, {\n      taskId,\n      subtaskId\n    }) {\n      const task = state.tasks.find(task => task.id === taskId);\n      if (!task) return;\n      const subtask = task.subtasks.find(t => t.id === subtaskId);\n      if (subtask) subtask.completed = !subtask.completed;\n      update_tasks_checked_state(state, task);\n    }\n  }\n});\nconst update_subtasks_checked_state = (state, task) => {\n  if (Array.isArray(task.subtasks)) {\n    task.subtasks.forEach(subtask => {\n      subtask.completed = task.completed;\n    });\n  }\n};\nconst update_tasks_checked_state = (state, task) => {\n  if (!Array.isArray(task.subtasks)) {\n    console.log('empty');\n    return;\n  }\n  task.completed = task.subtasks.every(subtask => subtask.completed);\n};","map":{"version":3,"names":["createStore","StorageKey","saveState","state","localStorage","setItem","JSON","stringify","loadState","json","getItem","parse","localStoragePlugin","store","subscribe","mutation","plugins","savedState","tasks","add_task","filter","getters","showTasks","showDoneTasks","completedCount","reduce","count","task","completed","length","mutations","ADD_TASK","taskText","newTask","id","Date","now","text","trim","subtasks","push","ADD_SUBTASK","taskId","subtaskText","newSubtask","currentTask","find","update_tasks_checked_state","DELETE_TASK","DELETE_SUBTASK","subtaskId","index","findIndex","s","splice","every","UPDATE_TASK_CHECKED","t","update_subtasks_checked_state","UPDATE_SUBTASK_CHECKED","subtask","Array","isArray","forEach","console","log"],"sources":["C:/Users/Pavel/Documents/webstorm/todo/src/store.js"],"sourcesContent":["import {createStore} from 'vuex'\r\n\r\nconst StorageKey = 'vue-todo-app'\r\n\r\nconst saveState = (state) => {\r\n  localStorage.setItem(StorageKey, JSON.stringify(state))\r\n}\r\n\r\nconst loadState = () => {\r\n  const json = localStorage.getItem(StorageKey)\r\n  return json ? JSON.parse(json) : null\r\n}\r\n\r\nconst localStoragePlugin = (store) => {\r\n  store.subscribe((mutation, state) => {\r\n    saveState(state);\r\n  });\r\n};\r\n\r\nexport default createStore({\r\n  plugins: [localStoragePlugin],\r\n  state() {\r\n    const savedState = loadState();\r\n    return savedState || {\r\n      tasks: [],\r\n      add_task: '',\r\n      filter: 'all'\r\n    }\r\n  },\r\n  getters: {\r\n    showTasks: (state) => state.tasks,\r\n    showDoneTasks: (state) => {\r\n      const completedCount = state.tasks.reduce((count, task) =>\r\n        task.completed ? count + 1 : count, 0);\r\n      return `${completedCount}/${state.tasks.length}`;\r\n    }\r\n  },\r\n  mutations: {\r\n    ADD_TASK(state, taskText) {\r\n      const newTask = {\r\n        id: Date.now(),\r\n        text: taskText.trim(),\r\n        completed: false,\r\n        subtasks: []\r\n      };\r\n      if (newTask.text) state.tasks.push(newTask);\r\n    },\r\n    ADD_SUBTASK(state, {taskId, subtaskText}) {\r\n      const newSubtask = {\r\n        id: Date.now(),\r\n        text: subtaskText.trim(),\r\n        completed: false,\r\n      };\r\n      const currentTask = state.tasks.find(task => task.id === taskId);\r\n      if (newSubtask.text && currentTask) {\r\n        currentTask.subtasks.push(newSubtask);\r\n      }\r\n      update_tasks_checked_state(state, currentTask)\r\n    },\r\n    DELETE_TASK(state, taskId) {\r\n      state.tasks = state.tasks.filter(task => task.id !== taskId);\r\n    },\r\n    DELETE_SUBTASK(state, { taskId, subtaskId }) {\r\n      const task = state.tasks.find(task => task.id === taskId);\r\n      if (!task?.subtasks) return;\r\n\r\n      const index = task.subtasks.findIndex(s => s.id === subtaskId);\r\n      if (index !== -1) {\r\n        task.subtasks.splice(index, 1);\r\n        task.completed = task.subtasks.length === 0\r\n          ? false\r\n          : task.subtasks.every(s => s.completed);\r\n      }\r\n    },\r\n    UPDATE_TASK_CHECKED(state, taskId) {\r\n      const task = state.tasks.find(t => t.id === taskId);\r\n      if (task) {\r\n        task.completed = !task.completed;\r\n        update_subtasks_checked_state(state, task);\r\n      }\r\n    },\r\n    UPDATE_SUBTASK_CHECKED(state, {taskId, subtaskId}) {\r\n      const task = state.tasks.find(task => task.id === taskId);\r\n      if (!task) return;\r\n      const subtask = task.subtasks.find(t => t.id === subtaskId);\r\n      if (subtask) subtask.completed = !subtask.completed;\r\n      update_tasks_checked_state(state, task)\r\n    }\r\n  }\r\n})\r\n\r\nconst update_subtasks_checked_state = (state, task) => {\r\n  if (Array.isArray(task.subtasks)) {\r\n    task.subtasks.forEach((subtask) => {\r\n      subtask.completed = task.completed;\r\n    });\r\n  }\r\n};\r\n\r\nconst update_tasks_checked_state = (state, task) => {\r\n  if (!Array.isArray(task.subtasks)) {\r\n    console.log('empty');\r\n    return;\r\n  }\r\n  task.completed = task.subtasks.every(subtask => subtask.completed);\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}